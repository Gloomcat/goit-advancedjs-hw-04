{"version":3,"file":"commonHelpers.js","sources":["../src/js/pixabay-api.js","../src/js/render-functions.js","../src/main.js"],"sourcesContent":["import axios from 'axios';\n\naxios.defaults.baseURL = 'https://pixabay.com';\n\nexport const fetchPhotos = async (query, page) => {\n  const config = {\n    params: {\n      key: '45271330-704da2140a32d702981ddfad2',\n      q: query,\n      safesearch: true,\n      orientation: 'horizontal',\n      page: page,\n      per_page: 15,\n    },\n  };\n\n  return axios.get('/api', config);\n  // return fetch(\n  //   `https://pixabay.com/api/?key=${API_KEY}&q=${encodeURIComponent(\n  //     query\n  //   )}&orientation=horizontal&safesearch=true&per_page=9&page=${page}`\n  // )\n};\n","import iziToast from 'izitoast';\nimport 'izitoast/dist/css/iziToast.min.css';\n\nimport SimpleLightbox from 'simplelightbox';\nimport 'simplelightbox/dist/simple-lightbox.min.css';\n\nlet lightbox = null;\n\nconst refreshLightbox = () => {\n  if (!lightbox) {\n    lightbox = new SimpleLightbox('.gallery a', {\n      captionsData: 'alt',\n      captionDelay: 250,\n    });\n  }\n\n  lightbox.refresh();\n};\n\nexport const showElement = (el, show) => {\n  if (show && el.classList.contains('hidden')) {\n    el.classList.remove('hidden');\n  } else if (!show && !el.classList.contains('hidden')) {\n    el.classList.add('hidden');\n  }\n};\n\nexport const showMessage = (message, messageType) => {\n  let settings = {\n    titleSize: '16px',\n    titleLineHeight: '24px',\n    titleColor: '#FFF',\n    messageSize: '16px',\n    messageLineHeight: '24px',\n    messageColor: '#FFF',\n    theme: 'dark',\n    position: 'topRight',\n    message: message,\n  };\n\n  if (messageType == 'error') {\n    settings.title = 'Error';\n    settings.backgroundColor = '#EF4040';\n    iziToast.error(settings);\n  } else if (messageType == 'info') {\n    settings.title = 'Info';\n    settings.backgroundColor = '#4E75FF';\n    iziToast.info(settings);\n  }\n};\n\nexport const fillGallery = (gallery, photosList) => {\n  const galleryItems = photosList.map(photo => {\n    return `\n        <div class='gallery-item'>\n            <a href=\"${photo.largeImageURL}\" class=\"gallery-link\">\n                <img src=\"${photo.previewURL}\" alt=\"${photo.tags}\" loading=\"lazy\" width=\"360\" height=\"150\"/>\n            </a>\n            <ul class=\"info\">\n                <li class=\"info-item\">\n                    <p class=\"info-category\">Likes</p>\n                    <p class=>${photo.likes}</p>\n                </li>\n                <li class=\"info-item\">\n                    <p class=\"info-category\">Views</p>\n                    <p class=>${photo.views}</p>\n                </li>\n                <li class=\"info-item\">\n                    <p class=\"info-category\">Comments</p>\n                    <p class=>${photo.comments}</p>\n                </li>\n                <li class=\"info-item\">\n                    <p class=\"info-category\">Downloads</p>\n                    <p class=>${photo.downloads}</p>\n                </li>\n            </ul>\n        </div>\n        `;\n  });\n  gallery.innerHTML += galleryItems.join('\\n');\n  refreshLightbox();\n};\n\nexport const clearGallery = gallery => {\n  gallery.innerHTML = '';\n  refreshLightbox();\n};\n\nexport const scrollGallery = gallery => {\n  const galleryItem = gallery.querySelector('div');\n  const scrollValue = galleryItem.getBoundingClientRect().height * 2;\n  const options = {\n    left: 0,\n    top: scrollValue,\n    behavior: 'smooth',\n  };\n  window.scrollBy(options);\n};\n","import { fetchPhotos } from './js/pixabay-api';\nimport {\n  clearGallery,\n  fillGallery,\n  scrollGallery,\n  showMessage,\n  showElement,\n} from './js/render-functions';\n\nclass GalleryController {\n  #currentPage;\n  #totalPages;\n  #query;\n  #gallery;\n  #loader;\n\n  constructor() {\n    this.form = document.querySelector('.form');\n    this.loadMoreButton = document.querySelector('.load-more');\n    this.#gallery = document.querySelector('.gallery');\n    this.#loader = document.querySelector('.loader');\n\n    this.#currentPage = 0;\n    this.#totalPages = 0;\n    this.#query = '';\n  }\n\n  setupQuery() {\n    const q = this.form.querySelector('input[name=\"query\"]').value.trim();\n    this.form.reset();\n    if (!q) {\n      showMessage(\n        'Search request should not be empty. Please try again!',\n        'error'\n      );\n      return false;\n    }\n\n    this.#query = q;\n    return true;\n  }\n\n  reset() {\n    clearGallery(this.#gallery);\n\n    showElement(this.loadMoreButton, false);\n\n    this.#query = '';\n    this.#currentPage = 0;\n    this.#totalPages = 0;\n  }\n\n  async fetchMore() {\n    showElement(this.loadMoreButton, false);\n    showElement(this.#loader, true);\n\n    this.#currentPage++;\n\n    try {\n      const data = await fetchPhotos(this.#query, this.#currentPage);\n      if (data.status !== 200) {\n        throw new Error(`Failed to load images, error code: ${data.status}`);\n      }\n\n      showElement(this.#loader, false);\n\n      const photosData = data.data;\n      if (!this.#totalPages) {\n        const total = parseInt(photosData.totalHits);\n        this.#totalPages = Math.floor(total / 15) + (total % 15 > 0 ? 1 : 0);\n      }\n\n      if (this.#totalPages > 0) {\n        fillGallery(this.#gallery, photosData.hits);\n      } else {\n        throw new Error(\n          'Sorry, there are no images matching your search query. Please try again!'\n        );\n      }\n\n      if (this.#currentPage === this.#totalPages) {\n        showElement(this.loadMoreButton, false);\n        showMessage(\n          \"We're sorry, but you've reached the end of search results.\",\n          'info'\n        );\n      } else {\n        showElement(this.loadMoreButton, true);\n      }\n\n      if (this.#currentPage > 1) {\n        scrollGallery(this.#gallery);\n      }\n    } catch (error) {\n      showMessage(error.message, 'error');\n    }\n  }\n}\n\nconst galleryController = new GalleryController();\n\ngalleryController.form.addEventListener('submit', event => {\n  event.preventDefault();\n\n  galleryController.reset();\n  if (galleryController.setupQuery()) {\n    galleryController.fetchMore();\n  }\n});\n\ngalleryController.loadMoreButton.addEventListener('click', () => {\n  galleryController.fetchMore();\n});\n"],"names":["axios","fetchPhotos","query","page","config","lightbox","refreshLightbox","SimpleLightbox","showElement","el","show","showMessage","message","messageType","settings","iziToast","fillGallery","gallery","photosList","galleryItems","photo","clearGallery","scrollGallery","options","GalleryController","__privateAdd","_currentPage","_totalPages","_query","_gallery","_loader","__privateSet","q","__privateGet","__privateWrapper","data","photosData","total","error","galleryController","event"],"mappings":"qpCAEAA,EAAM,SAAS,QAAU,sBAElB,MAAMC,EAAc,MAAOC,EAAOC,IAAS,CAChD,MAAMC,EAAS,CACb,OAAQ,CACN,IAAK,qCACL,EAAGF,EACH,WAAY,GACZ,YAAa,aACb,KAAMC,EACN,SAAU,EACX,CACL,EAEE,OAAOH,EAAM,IAAI,OAAQI,CAAM,CAMjC,EChBA,IAAIC,EAAW,KAEf,MAAMC,EAAkB,IAAM,CACvBD,IACHA,EAAW,IAAIE,EAAe,aAAc,CAC1C,aAAc,MACd,aAAc,GACpB,CAAK,GAGHF,EAAS,QAAO,CAClB,EAEaG,EAAc,CAACC,EAAIC,IAAS,CACnCA,GAAQD,EAAG,UAAU,SAAS,QAAQ,EACxCA,EAAG,UAAU,OAAO,QAAQ,EACnB,CAACC,GAAQ,CAACD,EAAG,UAAU,SAAS,QAAQ,GACjDA,EAAG,UAAU,IAAI,QAAQ,CAE7B,EAEaE,EAAc,CAACC,EAASC,IAAgB,CACnD,IAAIC,EAAW,CACb,UAAW,OACX,gBAAiB,OACjB,WAAY,OACZ,YAAa,OACb,kBAAmB,OACnB,aAAc,OACd,MAAO,OACP,SAAU,WACV,QAASF,CACb,EAEMC,GAAe,SACjBC,EAAS,MAAQ,QACjBA,EAAS,gBAAkB,UAC3BC,EAAS,MAAMD,CAAQ,GACdD,GAAe,SACxBC,EAAS,MAAQ,OACjBA,EAAS,gBAAkB,UAC3BC,EAAS,KAAKD,CAAQ,EAE1B,EAEaE,EAAc,CAACC,EAASC,IAAe,CAClD,MAAMC,EAAeD,EAAW,IAAIE,GAC3B;AAAA;AAAA,uBAEYA,EAAM,aAAa;AAAA,4BACdA,EAAM,UAAU,UAAUA,EAAM,IAAI;AAAA;AAAA;AAAA;AAAA;AAAA,gCAKhCA,EAAM,KAAK;AAAA;AAAA;AAAA;AAAA,gCAIXA,EAAM,KAAK;AAAA;AAAA;AAAA;AAAA,gCAIXA,EAAM,QAAQ;AAAA;AAAA;AAAA;AAAA,gCAIdA,EAAM,SAAS;AAAA;AAAA;AAAA;AAAA,SAK5C,EACDH,EAAQ,WAAaE,EAAa,KAAK;AAAA,CAAI,EAC3Cb,GACF,EAEae,EAAeJ,GAAW,CACrCA,EAAQ,UAAY,GACpBX,GACF,EAEagB,EAAgBL,GAAW,CAGtC,MAAMM,EAAU,CACd,KAAM,EACN,IAJkBN,EAAQ,cAAc,KAAK,EACf,sBAAqB,EAAG,OAAS,EAI/D,SAAU,QACd,EACE,OAAO,SAASM,CAAO,CACzB,gBCxFA,MAAMC,CAAkB,CAOtB,aAAc,CANdC,EAAA,KAAAC,EAAA,QACAD,EAAA,KAAAE,EAAA,QACAF,EAAA,KAAAG,EAAA,QACAH,EAAA,KAAAI,EAAA,QACAJ,EAAA,KAAAK,EAAA,QAGE,KAAK,KAAO,SAAS,cAAc,OAAO,EAC1C,KAAK,eAAiB,SAAS,cAAc,YAAY,EACzDC,EAAA,KAAKF,EAAW,SAAS,cAAc,UAAU,GACjDE,EAAA,KAAKD,EAAU,SAAS,cAAc,SAAS,GAE/CC,EAAA,KAAKL,EAAe,GACpBK,EAAA,KAAKJ,EAAc,GACnBI,EAAA,KAAKH,EAAS,GACf,CAED,YAAa,CACX,MAAMI,EAAI,KAAK,KAAK,cAAc,qBAAqB,EAAE,MAAM,OAE/D,OADA,KAAK,KAAK,QACLA,GAQLD,EAAA,KAAKH,EAASI,GACP,KARLrB,EACE,wDACA,OACR,EACa,GAKV,CAED,OAAQ,CACNU,EAAaY,EAAA,KAAKJ,EAAQ,EAE1BrB,EAAY,KAAK,eAAgB,EAAK,EAEtCuB,EAAA,KAAKH,EAAS,IACdG,EAAA,KAAKL,EAAe,GACpBK,EAAA,KAAKJ,EAAc,EACpB,CAED,MAAM,WAAY,CAChBnB,EAAY,KAAK,eAAgB,EAAK,EACtCA,EAAYyB,EAAA,KAAKH,GAAS,EAAI,EAE9BI,EAAA,KAAKR,GAAL,IAEA,GAAI,CACF,MAAMS,EAAO,MAAMlC,EAAYgC,EAAA,KAAKL,GAAQK,EAAA,KAAKP,EAAY,EAC7D,GAAIS,EAAK,SAAW,IAClB,MAAM,IAAI,MAAM,sCAAsCA,EAAK,MAAM,EAAE,EAGrE3B,EAAYyB,EAAA,KAAKH,GAAS,EAAK,EAE/B,MAAMM,EAAaD,EAAK,KACxB,GAAI,CAACF,EAAA,KAAKN,GAAa,CACrB,MAAMU,EAAQ,SAASD,EAAW,SAAS,EAC3CL,EAAA,KAAKJ,EAAc,KAAK,MAAMU,EAAQ,EAAE,GAAKA,EAAQ,GAAK,EAAI,EAAI,GACnE,CAED,GAAIJ,EAAA,KAAKN,GAAc,EACrBX,EAAYiB,EAAA,KAAKJ,GAAUO,EAAW,IAAI,MAE1C,OAAM,IAAI,MACR,0EACV,EAGUH,EAAA,KAAKP,KAAiBO,EAAA,KAAKN,IAC7BnB,EAAY,KAAK,eAAgB,EAAK,EACtCG,EACE,6DACA,MACV,GAEQH,EAAY,KAAK,eAAgB,EAAI,EAGnCyB,EAAA,KAAKP,GAAe,GACtBJ,EAAcW,EAAA,KAAKJ,EAAQ,CAE9B,OAAQS,EAAO,CACd3B,EAAY2B,EAAM,QAAS,OAAO,CACnC,CACF,CACH,CAvFEZ,EAAA,YACAC,EAAA,YACAC,EAAA,YACAC,EAAA,YACAC,EAAA,YAqFF,MAAMS,EAAoB,IAAIf,EAE9Be,EAAkB,KAAK,iBAAiB,SAAUC,GAAS,CACzDA,EAAM,eAAc,EAEpBD,EAAkB,MAAK,EACnBA,EAAkB,cACpBA,EAAkB,UAAS,CAE/B,CAAC,EAEDA,EAAkB,eAAe,iBAAiB,QAAS,IAAM,CAC/DA,EAAkB,UAAS,CAC7B,CAAC"}